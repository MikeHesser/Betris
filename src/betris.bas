100 REM BETRIS
110 REM written by Mike Hesser
120 REM Music by Andreas Weidner
130 REM -----------------------------------------
140 IF PEEK(&5000)=0 THEN SYMBOL AFTER 0:MEMORY &4FFF:LOAD"BETRIS.BIN",&5000
150 ENV 1,1,14,10,2,-1,5,5,-1,20
160 ENT -2,3,-1,1,2,0,1,6,1,1,2,0,1,3,-1,1  
170 INK 0,0:INK 1,2:INK 2,24:INK 3,7
180 IF PEEK(6)<>128 THEN a=&B736 ELSE a=&B296
190 zm=PEEK(a)+256*PEEK(a+1):MODE 1:WINDOW#1,12,22,1,24
200 b.init=&5000:b.game=&5003:comtab=200
210 FOR n=1 TO 19:READ a:stone$=stone$+CHR$(a):NEXT
220 SYMBOL 240,255,129,129,129,129,129,129,255
230 SYMBOL 241,0,126,66,66,66,66,126
240 SYMBOL 242,0,0,60,36,36,60
250 SYMBOL 243,0,0,0,24,24,0,0,0
260 DATA 22,1,15,1,240,8,15,2,241,8,15,3,242,8,15,1,243,22,0
270 POKE &B28B,100:FOR n=1 TO 24:LOCATE 11,n:PRINT stone$;SPC(11);stone$:NEXT
280 FOR n=11 TO 23:LOCATE n,25:PRINT stone$;:NEXT:POKE &B28B,40
290 READ x,y,t$:IF x<>-1 THEN LOCATE x,y:GOSUB 510:GOTO 290
300 PEN 1:LOCATE 3,23:PRINT "00000":LOCATE 4,13:PRINT "and"
310 LOCATE 1,14:PRINT "A.Weidner"
320 CLS#1:LOCATE 15,10:PRINT"LEVEL":LOCATE 14,11:PRINT"(0..9)"
330 PEN 1:LOCATE 3,18:PRINT "00000":WHILE INKEY$<>"":WEND
340 RESTORE 710:bi=0:f=1
350 READ th,d:IF th=-1 THEN RESTORE 710:f=(f+1)MOD 3:GOTO 350
360 bi=bi+d
370 IF bi<5 THEN b=851 ELSE IF bi<9 THEN b=638 ELSE IF bi<17 THEN b=568 ELSE bi=0:GOTO 370
380 SOUND 5+16,th*f/2,d*25,0,1:SOUND 2+40,b,d*25,15,1,2
390 a$=INKEY$:IF a$="" THEN 350:IF a$<"0" OR a$>"9" THEN 350
400 s=10-VAL(a$):FOR n=10 TO 11:LOCATE 14,n:PRINT SPACE$(8):NEXT
410 GOSUB 650:POKE comtab,s/2:CALL b.init:POKE comtab+4,24
420 POKE comtab+1,s*8:CALL b.game:h=(PEEK(comtab+2)+256*PEEK(comtab+3))
430 IF h=0 THEN 460
440 score=score+h:p=score:POKE comtab+2,0:POKE comtab+3,0:LOCATE 3,18:GOSUB 640
450 IF PEEK(comtab+4)>1 THEN 420
460 IF score>high THEN high=score:LOCATE 3,23:p=high:GOSUB 640
470 FOR n=10 TO 17:LOCATE 12,n:PRINT SPACE$(11);:NEXT
480 LOCATE 13,12:t$="GAME OVER":GOSUB 510
490 FOR n=500 TO 1000 STEP 3:SOUND 1,n,2,1,1,2:NEXT 
500 WHILE INKEY$<>"":WEND:GOTO 320
510 FOR n=1 TO LEN(t$):a=ASC(MID$(t$,n,1)):zadr=zm+a*8
520 FOR y=0 TO 7:b(y)=PEEK(zadr+y):NEXT
530 SYMBOL 244,b(0),b(0),b(1),b(1),b(2),b(2),b(3),b(3)
540 SYMBOL 245,b(4),b(4),b(5),b(5):SYMBOL 246,0,0,0,0,b(6),b(6),b(7),b(7)
550 PEN 1:PRINT CHR$(244);CHR$(8);CHR$(10);
560 PEN 2:PRINT CHR$(245)+CHR$(8);:PEN 3:PRINT CHR$(22)"1";CHR$(246)+CHR$(11);
570 NEXT:PRINT CHR$(22)"0";:RETURN
580 DATA 2,1,"-BETRIS-",1,4,"(C) Copy-",1,6,"right by",3,9,"MIKE"
590 DATA 2,11,"HESSER",3,16,"SCORE",3,21,"HIGH"
600 DATA 28,2,"/  ROTATE",27,4,"ANTICLOCKWISE",28,8,"\  ROTATE"
610 DATA 29,10,"CLOCKWISE",27,14,"Z  STEP LEFT",27,18,"X STEP RIGHT"
620 DATA 25,23,"OR USE JOYSTICK"
630 DATA -1,-1,""
640 t$="00000":a$=MID$(STR$(p),2):MID$(t$,6-LEN(a$))=a$:PEN 1:PRINT t$:RETURN
650 RESTORE 690
660 READ a,b:IF a=-1 THEN RETURN
670 SOUND 1,a,b-3,1,1,2:SOUND 2,a-6,b-3,1,1,2
680 WHILE SQ(1)>127:WEND:GOTO 660  
690 DATA 770,25,770,12.5,770,12.5,623,12.5,770,12.5
700 DATA 623,12.5,513,12.5,366,30,366,12,366,12,366,20,-1,-1
710 DATA 142,2,142,1,142,1,127,1,127,3,0,5,169,1,127,1,127,1
720 DATA 142,2,127,1,159,1,142,1,142,3,0,8,169,2,159,1,142,1,127,4
730 DATA 142,4,0,1,127,1,159,1,190,1,213,2,213,1,225,1,253,4
740 DATA 284,2,0,3,213,1,190,1,213,1,190,2,190,1,213,1,190,1,190,3 
750 DATA 0,5,190,1,169,1,159,1,169,2,213,1,253,1,190,1,190,3 
760 DATA 190,2,0,3,213,1,190,2,213,1,190,2,190,1,213,1,190,1,190,1,0,2 
770 DATA 0,5,190,1,142,1,142,1,142,4,142,1,159,2,213,1
780 DATA 190,1,190,1,190,2,0,1,190,1,169,1,159,1,142,1,142,2,142,1,127,4
790 DATA 142,4,0,1,127,1,159,1,190,1,213,2,213,1,225,1,253,4,284,4,0,4
800 DATA -1,-1